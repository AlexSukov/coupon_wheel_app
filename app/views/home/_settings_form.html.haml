= form_with(model: setting, local: true) do |form|
  - if setting.errors.any?
    #error_explanation
      %h2
        = pluralize(setting.errors.count, "error")
        prohibited this setting from being saved:
      %ul
        - setting.errors.full_messages.each do |message|
          %li= message
  %h2 General
  .form-group
    = form.label :enable, 'Enable App'
    = form.check_box :enable, id: :setting_enable
  .form-group
    - if setting.big_logo.present?
      = image_tag setting.big_logo, class: "big-logo"
    = form.label :big_logo
    = form.file_field :big_logo, id: :setting_big_logo, class: 'form-control'
  .form-group
    - if setting.small_logo.present?
      = image_tag setting.small_logo, class: "big-logo"
    = form.label :small_logo
    = form.file_field :small_logo, id: :setting_small_logo, class: 'form-control'

  %h2 Advanced
  .form-group
    = form.label :title_text
    = form.text_field :title_text, id: :setting_title_text, class: 'form-control'
  .form-group
    = form.label :disclaimer_text
    = form.text_area :disclaimer_text, id: :disclaimer_text, class: 'form-control'
  .form-group
    = form.label :guiding_text
    = form.text_area :guiding_text, id: :setting_guiding_text, class: 'form-control'
  .form-group
    = form.label :enter_email
    = form.text_field :enter_email, id: :setting_enter_email, class: 'form-control'
  .form-group
    = form.label :invalid_email_message
    = form.text_field :invalid_email_message, id: :setting_invalid_email_message, class: 'form-control'
  .form-group
    = form.label :spin_button
    = form.text_field :spin_button, id: :setting_spin_button, class: 'form-control'
  .form-group
    = form.label :close_button
    = form.text_field :close_button, id: :setting_close_button, class: 'form-control'
  .form-group
    = form.label :winning_title
    = form.text_field :winning_title, id: :setting_winning_title, class: 'form-control'
  .form-group
    = form.label :winning_text
    = form.text_field :winning_text, id: :setting_winning_text, class: 'form-control'
  .form-group
    = form.label :discount_code_title
    = form.text_field :discount_code_title, id: :setting_discount_code_title, class: 'form-control'
  .form-group
    = form.label :continue_button
    = form.text_field :continue_button, id: :setting_continue_button, class: 'form-control'
  .form-group
    = form.label :copied_message
    = form.text_field :copied_message, id: :setting_copied_message, class: 'form-control'
  .form-group
    = form.label :reject_discount_button
    = form.text_field :reject_discount_button, id: :setting_reject_discount_button, class: 'form-control'
  .form-group
    = form.label :free_product_description
    = form.text_field :free_product_description, id: :setting_free_product_description, class: 'form-control'
  .form-group
    = form.label :free_product_button
    = form.text_field :free_product_button, id: :setting_free_product_button, class: 'form-control'
  .form-group
    = form.label :free_product_reject
    = form.text_field :free_product_reject, id: :setting_free_product_reject, class: 'form-control'
  .form-group
    = form.label :discount_coupon_code_bar
    = form.text_field :discount_coupon_code_bar, id: :setting_discount_coupon_code_bar, class: 'form-control'
  .form-group
    = form.label :close_button_in_bar
    = form.text_field :close_button_in_bar, id: :setting_close_button_in_bar, class: 'form-control'

  %h2 Colors
  .form-group
    - theme_options = [ ["Default", 'Default'], ["Madrid", 'Madrid'] ]
    - selected_theme = setting.theme
    = form.label :theme
    = form.select :theme, options_for_select(theme_options, selected_theme), id: :setting_theme, class: 'form-control'

  .form-group
    = form.label :background_color
    = form.text_field :background_color, id: :setting_background_color, class: 'form-control'
  .form-group
    = form.label :font_color
    = form.text_field :font_color, id: :setting_font_color, class: 'form-control'
  .form-group
    = form.label :bold_text_and_button_color
    = form.text_field :bold_text_and_button_color, id: :setting_bold_text_and_button_color, class: 'form-control'
  .form-group
    = form.label :win_section_color
    = form.text_field :win_section_color, id: :setting_win_section_color, class: 'form-control'
  .form-group
    = form.label :lose_section_color
    = form.text_field :lose_section_color, id: :setting_lose_section_color, class: 'form-control'

  %h2 Slices
  #slice-container
    - slices.each_with_index do |slice, index|
      = render 'slice_form', slice: slice, index: index+1
  %button.create_slice{'data-setting': @settings.id, type: 'button' } Add Slice
  %br

  %h2 Discount code bar
  .form-group
    = form.label :enable_discount_code_bar
    = form.check_box :enable_discount_code_bar, id: :setting_enable_discount_code_bar
  .form-group
    = form.label :discount_code_bar_countdown_time
    = form.number_field :discount_code_bar_countdown_time, id: :setting_discount_code_bar_countdown_time, min: 0, class: 'form-control'
  .form-group
    - discount_position_options = [ ["Screen Top", 'Screen Top'], ["Screen Bottom", 'Screen Bottom'], ["Page Top", 'Page Top'], ["Page Bottom", 'Page Bottom']]
    - selected_discount_position = setting.discount_code_bar_position
    = form.label :discount_code_bar_position
    = form.select :discount_code_bar_position, options_for_select(discount_position_options, selected_discount_position), id: :setting_discount_code_bar_position, class: 'form-control'

  %h2 Progress bar
  .form-group
    = form.label :enable_progress_bar
    = form.check_box :enable_progress_bar, id: :setting_enable_progress_bar
  .form-group
    = form.label :progress_bar_text
    = form.text_field :progress_bar_text, id: :setting_progress_bar_text, class: 'form-control'
  .form-group
    = form.label :progress_bar_color
    = form.text_field :progress_bar_color, id: :setting_progress_bar_color, class: 'form-control'
  .form-group
    = form.label :progress_bar_percentage
    = form.number_field :progress_bar_percentage, id: :setting_progress_bar_percentage, min: 0, max: 100, class: 'form-control'
  .form-group
    - progress_position_options = [ ["Under Top Title", 'Under Top Title'], ["Under Main Text", 'Under Main Text'], ["Under Spin Button", 'Under Spin Button'] ]
    - selected_progress_position = setting.progress_bar_position
    = form.label :progress_bar_position
    = form.select :progress_bar_position, options_for_select(progress_position_options, selected_progress_position), id: :setting_progress_bar_position, class: 'form-control'

  %h2 Show on devices
  .form-group
    = form.label :show_on_desktop
    = form.check_box :show_on_desktop, id: :setting_show_on_desktop
  .form-group
    = form.label :show_on_mobile
    = form.check_box :show_on_mobile, id: :setting_show_on_mobile
  .form-group
    = form.label :show_on_desktop_leave_intent
    = form.check_box :show_on_desktop_leave_intent, id: :setting_show_on_desktop_leave_intent
  .form-group
    = form.label :show_on_mobile_leave_intent
    = form.check_box :show_on_mobile_leave_intent, id: :setting_show_on_mobile_leave_intent
  .form-group
    = form.label :show_on_desktop_after
    = form.check_box :show_on_desktop_after, id: :setting_show_on_desktop_after
  .form-group
    = form.label :show_on_mobile_after
    = form.check_box :show_on_mobile_after, id: :setting_show_on_mobile_after
  .form-group
    = form.label :show_on_desktop_seconds
    = form.number_field :show_on_desktop_seconds, id: :setting_show_on_desktop_seconds, min: 0, class: 'form-control'
  .form-group
    = form.label :show_on_mobile_seconds
    = form.number_field :show_on_mobile_seconds, id: :setting_show_on_mobile_seconds, min: 0, class: 'form-control'

  %h2 Pull-out-tab
  .form-group
    = form.label :show_pull_out_tab
    = form.check_box :show_pull_out_tab, id: :setting_show_pull_out_tab
  .form-group
    - if setting.tab_icon.present?
      = image_tag setting.tab_icon, class: "tab-icon"
    = form.label :tab_icon
    = form.file_field :tab_icon, id: :setting_tab_icon, class: 'form-control'

  %h2 Don't show app
  .form-group
    = form.label :do_not_show_app
    = form.number_field :do_not_show_app, id: :setting_do_not_show_app, min: 0, class: 'form-control'

  %h2 URL filter
  #url_filters{'data-setting-id': setting.id}
    -if setting.url_filters?
      -setting.url_filters.each do |url|
        .url
          = url
          %button.url_delete{'data-url': url, type: 'button' } Delete URL
  %button.add_url{type: 'button'} Add URL

  %h2 Discount coupon auto apply
  .form-group
    = form.label :discount_coupon_auto_apply
    = form.check_box :discount_coupon_auto_apply, id: :setting_discount_coupon_auto_apply

  %h2 E-mails Integration

  %h3 Mailchimp
  #mailchimp
    .form-group
      = form.label :mailchimp_enable
      = form.check_box :mailchimp_enable, id: :setting_mailchimp_enable
    .form-group
      = form.label :mailchimp_api_key
      = form.text_field :mailchimp_api_key, id: :setting_mailchimp_api_key, class: 'form-control'
    -if setting.mailchimp_api_key?
      -if setting.mailchimp_list_id?
        :javascript
          displayMailchimpList("#{setting.mailchimp_api_key}", "#{setting.mailchimp_list_id}")
    .form-group
      = form.hidden_field :mailchimp_list_id, id: :setting_mailchimp_list_id, class: 'form-control'

  %h3 Klaviyo
  #klaviyo
    .form-group
      = form.label :klaviyo_enable
      = form.check_box :klaviyo_enable, id: :setting_klaviyo_enable
    .form-group
      = form.label :klaviyo_api_key
      = form.text_field :klaviyo_api_key, id: :setting_klaviyo_api_key, class: 'form-control'
    -if setting.klaviyo_api_key?
      -if setting.klaviyo_list_id?
        :javascript
          displayKlaviyoList("#{setting.klaviyo_api_key}", "#{setting.klaviyo_list_id}")
    .form-group
      = form.hidden_field :klaviyo_list_id, id: :setting_klaviyo_list_id, class: 'form-control'

  .actions
    = form.submit 'Save', id: 'setting_save'
